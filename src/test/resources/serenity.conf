webdriver {
  autodownload = true
  headless.mode = true
}

serenity {
  project.name = "w3.org cucumber tests"
  take.screenshots = FOR_FAILURES
  console.colors = true
  restart.browser.for.each = scenario
  use.unique.browser = true
  browser.maximized = true
}

environments {
  default {
    w3.base.url = "https://www.w3.org"
  }
}

environment = run_with_chrome

environments {
  run_with_chrome {
    webdriver.driver = chrome
    chrome {
      switches = "--start-maximized;--enable-automation;--no-sandbox;--disable-popup-blocking;--disable-default-apps;--disable-infobars;--disable-gpu;--disable-extensions;"
      preferences {
        download: {
          prompt_for_download: false
          directory_upgrade: true
          default_directory: "${user.dir}/downloaded-files"
        }
      }
    }
  }
  run_with_firefox {
    webdriver.driver = firefox

    firefox {
      arguments = "-headless"
      preferences {
        browser {
          download {
            folderList = 2
            dir = "$TEMPDIR/downloads"
            manager.showWhenStarting = false
            useDownloadDir = true
          }
          helperApps {
            neverAsk.saveToDisk = "application/octet-stream"
            alwaysAsk.force = false
          }
        }
      }
      logLevel = INFO
      acceptInsecureCerts = true
      pageLoadStrategy = EAGER
    }
  }
}
